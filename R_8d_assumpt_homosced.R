##################################################################################################################################################################
##################################################################################################################################################################
##################################################################################################################################################################
### Aim: Check the assumption on homoscedastic residuals

##################################################################################################################################################################
## Scenario 1: homoscedastic residuals

b1 <- b1_SE <- b1_pval <- NULL

for(i in 1:10000){
  print(i)
  X1 <- rnorm(1000, mean=0, sd=1)
  Y	<- 0.3*X1 + rnorm(1000,mean=0,sd=1)	
  help <- summary(lm(Y~X1))$coefficients
  b1[i]      <- help[2,1]
  b1_SE[i]   <- help[2,2]
  b1_pval[i] <- help[2,4]
}

> summary(b1)
Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.1816  0.2794  0.3010  0.3008  0.3223  0.4235 
> summary(b1_SE)
Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.02832 0.03098 0.03166 0.03167 0.03236 0.03592 
> sd(b1)
[1] 0.03155079
> summary(b1_pval)
Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
0.000e+00 0.000e+00 0.000e+00 2.079e-12 0.000e+00 4.657e-09 

##################################################################################################################################################################
## Scenario 2: heteroscedastic residuals

b1 <- b1_SE <- b1_pval <- NULL

for(i in 1:10000){
  print(i)
  X1 <- rnorm(1000, mean=0, sd=1)
  Y	<- 0.3*X1 + X1*rnorm(1000,mean=0,sd=1)	
  help <- lm(Y~X1)
  b1[i]      <- summary(help)$coefficients[2,1]
  b1_SE[i]   <- summary(help)$coefficients[2,2]
  b1_pval[i] <- summary(help)$coefficients[2,4]
}

plot(help)

> summary(b1)
Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.07376 0.26444 0.30008 0.30045 0.33709 0.50639 
> summary(b1_SE)
Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.02736 0.03072 0.03154 0.03156 0.03237 0.03776 
> sd(b1)
[1] 0.05456796
> summary(b1_pval)
Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
0.000e+00 0.000e+00 0.000e+00 2.507e-06 0.000e+00 1.867e-02 